/*!
ModalConfirm popup modal confirmation-dialog
Version 2.1
Copyright (C) 2014-2015 Tom Phane
Licensed under the GNU Affero GPL license v.3, or at the distributor's discretion, a later version
*/
(function(a){a.extend({modalconfirm:new function(){this.defaults={confirmBtnID:"mc_conf",denyBtnID:"mc_deny",showBtn:"both",confirmCss:null,denyCss:null,doCheck:null,onCheckFail:null,onConfirm:null,onDeny:null,overlayID:"mc_overlay",popupID:null,preShow:null};this.construct=function(d){var e=a.extend({},a.modalconfirm.defaults,d||{});this.each(function(){a(this).bind("click.mc_confirm",e,b)});return this};function b(h){var f=h.data,e=h.currentTarget;if(!a.isFunction(f.doCheck)||f.doCheck.call(this)){h.stopImmediatePropagation();h.preventDefault();var m=a("#"+f.overlayID),d=(f.popupID)?a("#"+f.popupID):overlay.children(":first");if(f.showBtn!="deny"){d.find("#"+f.confirmBtnID).click(function(p){p.stopImmediatePropagation();c(m,d,f);var o;if(a.isFunction(f.onConfirm)){o=f.onConfirm.call(this,e,d)}else{o=(f.onConfirm===null||f.onConfirm!==false)}if(o){var q=a(e);q.unbind("click.mc_confirm");e.click();q.bind("click.mc_confirm",f,b)}})}else{var l=d.find("#"+f.confirmBtnID);f.confirmCss=l.css("display");l.css("display","none")}if(f.showBtn!="confirm"){d.find("#"+f.denyBtnID).click(function(o){o.stopImmediatePropagation();o.preventDefault();c(m,d,f);a.isFunction(f.onDeny)&&f.onDeny.call(this,e)})}else{l=d.find("#"+f.denyBtnID);f.denyCss=l.css("display");l.css("display","none")}a.isFunction(f.preShow)&&f.preShow.call(this,e,d);var g=d.height();var j=d.width();var n=-d.outerHeight()/2;var i=-d.outerWidth()/2;m.css("display","block");d.css({"margin-top":n+"px","margin-left":i+"px",height:g+"px",width:j+"px",display:"block"})}else{var k;if(f.onCheckFail){if(a.isFunction(f.onCheckFail)){k=!f.onCheckFail.call(this,e)}else{k=(f.onCheckFail===false)}}else{k=true}if(k){a.isFunction(f.onDeny)&&f.onDeny.call(this,e);h.stopImmediatePropagation();h.preventDefault()}}}function c(d,f,e){f.css({display:"none"});d.css({display:"none"});if(e.confirmCss){f.find("#"+e.confirmBtnID).css("display",e.confirmCss);e.confirmCss=null}if(e.denyCss){f.find("#"+e.denyBtnID).css("display",e.denyCss);e.denyCss=null}}this.show=function(l){var e=a.extend({},a.modalconfirm.defaults,l||{}),j=a("#"+e.overlayID),d=(e.popupID)?a("#"+e.popupID):overlay.children(":first");if(e.showBtn!="deny"){d.find("#"+e.confirmBtnID).click(function(m){m.stopImmediatePropagation();c(j,d,e);a.isFunction(e.onConfirm)&&e.onConfirm.call(this,null,d)})}else{var i=d.find("#"+e.confirmBtnID);e.confirmCss=i.css("display");i.css("display","none")}if(e.showBtn!="confirm"){d.find("#"+e.denyBtnID).click(function(m){m.stopImmediatePropagation();m.preventDefault();c(j,d,e);a.isFunction(e.onDeny)&&e.onDeny.call(this,null)})}else{i=d.find("#"+e.denyBtnID);e.denyCss=i.css("display");i.css("display","none")}a.isFunction(e.preShow)&&e.preShow.call(this,null,d);var f=d.height();var h=d.width();var k=-d.outerHeight()/2;var g=-d.outerWidth()/2;j.css("display","block");d.css({"margin-top":k+"px","margin-left":g+"px",height:f+"px",width:h+"px",display:"block"})}}});a.fn.extend({modalconfirm:a.modalconfirm.construct})})(jQuery);