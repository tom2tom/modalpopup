/*!
ModalConfirm popup modal confirmation-dialog
Version 1.1
Copyright (C) 2014-2015 Tom Phane
Licensed under the GNU Affero GPL license v.3, or at the distributor's discretion, a later version
*/
(function(a){a.extend({modalconfirm:new function(){this.defaults={confirmBtnID:"mc_conf",denyBtnID:"mc_deny",doCheck:null,onCheckFail:null,onConfirm:null,onDeny:null,overlayID:"mc_overlay",popupID:null,preShow:null};this.construct=function(d){var e=a.extend({},a.modalconfirm.defaults,d||{});this.each(function(){a(this).bind("click.mc_confirm",e,b)});return this};function b(i){var f=i.data;var e=i.target;if(!a.isFunction(f.doCheck)||f.doCheck.call()){i.stopImmediatePropagation();i.preventDefault();var h=a("#"+f.overlayID);h.css({display:"block"});var d=(f.popupID)?a("#"+f.popupID):h.children(":first");d.find("#"+f.confirmBtnID).click(function(o){o.stopImmediatePropagation();c(h,d);var n;if(a.isFunction(f.onConfirm)){n=f.onConfirm.call(e)}else{n=(f.onConfirm===null||f.onConfirm!==false)}if(n){a(e).unbind("click.mc_confirm").trigger("click");a(e).bind("click.mc_confirm",f,b)}});d.find("#"+f.denyBtnID).click(function(n){n.stopImmediatePropagation();c(h,d);a.isFunction(f.onDeny)&&f.onDeny.call(e)});if(a.isFunction(f.preShow)){f.preShow.call(e,d)}var g=d.height();var k=d.width();var m=-d.outerHeight()/2;var j=-d.outerWidth()/2;d.css({"margin-top":m+"px","margin-left":j+"px",height:g+"px",width:k+"px",display:"block"})}else{if(f.onCheckFail){var l;if(a.isFunction(f.onCheckFail)){l=!f.onCheckFail.call(e)}else{if(a.isFunction(f.onConfirm)){l=!f.onConfirm.call(e)}else{l=(f.onConfirm===false)}}if(l){i.stopImmediatePropagation();i.preventDefault()}}else{if(a.isFunction(f.onDeny)){f.onDeny.call(e)}}}}function c(e,d){d.css({display:"none"});e.css({display:"none"})}}});a.fn.extend({modalconfirm:a.modalconfirm.construct})})(jQuery);